!function(){const e={type:"change"},t={type:"start"},o={type:"end"};class n extends THREE.EventDispatcher{constructor(n,c){function i(e){!1!==O.enabled&&(0===Z.length&&(O.domElement.setPointerCapture(e.pointerId),O.domElement.addEventListener("pointerup",s)),T(e),"touch"===e.pointerType?h(e):E(e))}function a(e){O.mousePosition.copy(U(e.pageX,e.pageY)),!1!==O.enabled&&("touch"===e.pointerType?y(e):l(e))}function s(e){!1!==O.enabled&&("touch"===e.pointerType?g(e):m(),w(e),0===Z.length&&(O.domElement.releasePointerCapture(e.pointerId),O.domElement.removeEventListener("pointerup",s)))}function r(e){w(e)}function p(e){!1!==O.enabled&&(window.removeEventListener("keydown",p),V===R.NONE&&(e.code!==O.keys[R.ROTATE]||O.noRotate?e.code!==O.keys[R.ZOOM]||O.noZoom?e.code!==O.keys[R.PAN]||O.noPan||(V=R.PAN):V=R.ZOOM:V=R.ROTATE))}function d(){!1!==O.enabled&&(V=R.NONE,window.addEventListener("keydown",p))}function E(e){if(L===R.NONE)switch(e.button){case O.mouseButtons.LEFT:L=R.ROTATE;break;case O.mouseButtons.MIDDLE:L=R.ZOOM;break;case O.mouseButtons.RIGHT:L=R.PAN;break;default:L=R.NONE}const o=V!==R.NONE?V:L;o!==R.ROTATE||O.noRotate?o!==R.ZOOM||O.noZoom?o!==R.PAN||O.noPan||(S.copy(U(e.pageX,e.pageY)),X.copy(S)):(D.copy(U(e.pageX,e.pageY)),Y.copy(D)):(M.copy(_(e.pageX,e.pageY)),z.copy(M)),O.dispatchEvent(t)}function l(e){const t=V!==R.NONE?V:L;t!==R.ROTATE||O.noRotate?t!==R.ZOOM||O.noZoom?t!==R.PAN||O.noPan||X.copy(U(e.pageX,e.pageY)):Y.copy(U(e.pageX,e.pageY)):(z.copy(M),M.copy(_(e.pageX,e.pageY)))}function m(){L=R.NONE,O.dispatchEvent(o)}function u(e){if(!1!==O.enabled&&!0!==O.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:D.y-=.025*e.deltaY;break;case 1:D.y-=.01*e.deltaY;break;default:D.y-=25e-5*e.deltaY}O.dispatchEvent(t),O.dispatchEvent(o)}}function h(e){switch(j(e),Z.length){case 1:L=R.TOUCH_ROTATE,M.copy(_(Z[0].pageX,Z[0].pageY)),z.copy(M);break;default:L=R.TOUCH_ZOOM_PAN;const t=Z[0].pageX-Z[1].pageX,o=Z[0].pageY-Z[1].pageY;A=k=Math.sqrt(t*t+o*o);const n=(Z[0].pageX+Z[1].pageX)/2,c=(Z[0].pageY+Z[1].pageY)/2;S.copy(U(n,c)),X.copy(S)}O.dispatchEvent(t)}function y(e){switch(j(e),Z.length){case 1:z.copy(M),M.copy(_(e.pageX,e.pageY));break;default:const t=f(e),o=e.pageX-t.x,n=e.pageY-t.y;A=Math.sqrt(o*o+n*n);const c=(e.pageX+t.x)/2,i=(e.pageY+t.y)/2;X.copy(U(c,i))}}function g(e){switch(Z.length){case 0:L=R.NONE;break;case 1:L=R.TOUCH_ROTATE,M.copy(_(e.pageX,e.pageY)),z.copy(M);break;case 2:L=R.TOUCH_ZOOM_PAN,M.copy(_(e.pageX-z.pageX,e.pageY-z.pageY)),z.copy(M)}O.dispatchEvent(o)}function b(e){!1!==O.enabled&&e.preventDefault()}function T(e){Z.push(e)}function w(e){delete I[e.pointerId];for(let t=0;t<Z.length;t++)if(Z[t].pointerId==e.pointerId)return void Z.splice(t,1)}function j(e){let t=I[e.pointerId];t===undefined&&(t=new THREE.Vector2,I[e.pointerId]=t),t.set(e.pageX,e.pageY)}function f(e){const t=e.pointerId===Z[0].pointerId?Z[1]:Z[0];return I[t.pointerId]}super(),c===undefined&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),c===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const O=this,R={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=n,this.domElement=c,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=Infinity,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.mousePosition=new THREE.Vector2,this.target=new THREE.Vector3;const v=1e-6,H=new THREE.Vector3;let N=1,L=R.NONE,V=R.NONE,k=0,A=0,P=0;const C=new THREE.Vector3,z=new THREE.Vector2,M=new THREE.Vector2,x=new THREE.Vector3,D=new THREE.Vector2,Y=new THREE.Vector2,S=new THREE.Vector2,X=new THREE.Vector2,Z=[],I={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const e=O.domElement.getBoundingClientRect(),t=O.domElement.ownerDocument.documentElement;O.screen.left=e.left+window.pageXOffset-t.clientLeft,O.screen.top=e.top+window.pageYOffset-t.clientTop,O.screen.width=e.width,O.screen.height=e.height};const U=function(){const e=new THREE.Vector2;return function(t,o){return e.set((t-O.screen.left)/O.screen.width,(o-O.screen.top)/O.screen.height),e}}(),_=function(){const e=new THREE.Vector2;return function(t,o){return e.set((t-.5*O.screen.width-O.screen.left)/(.5*O.screen.width),(O.screen.height+2*(O.screen.top-o))/O.screen.width),e}}();this.rotateCamera=function(){const e=new THREE.Vector3,t=new THREE.Quaternion,o=new THREE.Vector3,n=new THREE.Vector3,c=new THREE.Vector3,i=new THREE.Vector3;return function(){i.set(M.x-z.x,M.y-z.y,0);let a=i.length();a?(C.copy(O.object.position).sub(O.target),o.copy(C).normalize(),n.copy(O.object.up).normalize(),c.crossVectors(n,o).normalize(),n.setLength(M.y-z.y),c.setLength(M.x-z.x),i.copy(n.add(c)),e.crossVectors(i,C).normalize(),a*=O.rotateSpeed,t.setFromAxisAngle(e,a),C.applyQuaternion(t),O.object.up.applyQuaternion(t),x.copy(e),P=a):!O.staticMoving&&P&&(P*=Math.sqrt(1-O.dynamicDampingFactor),C.copy(O.object.position).sub(O.target),t.setFromAxisAngle(x,P),C.applyQuaternion(t),O.object.up.applyQuaternion(t)),z.copy(M)}}(),this.zoomCamera=function(){let e;if(L===R.TOUCH_ZOOM_PAN)e=k/A,k=A,O.object.isPerspectiveCamera?C.multiplyScalar(e):O.object.isOrthographicCamera?(O.object.zoom*=e,O.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type");else{var t=Y.y-D.y;if(1!==(e=1+(Y.y-D.y)*O.zoomSpeed)&&e>0){var o=new THREE.Vector3;if(t<0){o.set(O.mousePosition.x,O.mousePosition.y,0),(o=o.addScalar(-.5).multiplyScalar(2)).unproject(O.object);var n=o.sub(O.object.position).normalize(),c=-O.object.position.z/n.z,i=n.multiplyScalar(c);o=O.object.position.clone().add(i)}else o.set(0,0,1),o=O.object.position.clone().sub(o);var a=(C.clone().multiplyScalar(e).z-C.clone().z)/O.object.position.z,s=new THREE.Vector3,r=new THREE.Vector3,p=o.x-O.object.position.x,d=o.y-O.object.position.y,E=new THREE.Vector2(p*a,d*a);s.copy(C).cross(O.object.up).setLength(E.x),s.add(r.copy(O.object.up).setLength(E.y)),O.target.add(s),O.object.isPerspectiveCamera?C.multiplyScalar(e):O.object.isOrthographicCamera?(O.object.zoom/=e,O.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")}O.staticMoving?D.copy(Y):D.y+=(Y.y-D.y)*this.dynamicDampingFactor}},this.panCamera=function(){const e=new THREE.Vector2,t=new THREE.Vector3,o=new THREE.Vector3;return function(){if(e.copy(X).sub(S),e.lengthSq()){if(O.object.isOrthographicCamera){const t=(O.object.right-O.object.left)/O.object.zoom/O.domElement.clientWidth,o=(O.object.top-O.object.bottom)/O.object.zoom/O.domElement.clientWidth;e.x*=t,e.y*=o}e.multiplyScalar(C.length()*O.panSpeed),o.copy(C).cross(O.object.up).setLength(e.x),o.add(t.copy(O.object.up).setLength(e.y)),O.object.position.add(o),O.target.add(o),O.staticMoving?S.copy(X):S.add(e.subVectors(X,S).multiplyScalar(O.dynamicDampingFactor))}}}(),this.checkDistances=function(){O.noZoom&&O.noPan||(C.lengthSq()>O.maxDistance*O.maxDistance&&(O.object.position.addVectors(O.target,C.setLength(O.maxDistance)),D.copy(Y)),C.lengthSq()<O.minDistance*O.minDistance&&(O.object.position.addVectors(O.target,C.setLength(O.minDistance)),D.copy(Y)))},this.update=function(){C.subVectors(O.object.position,O.target),O.noRotate||O.rotateCamera(),O.noZoom||O.zoomCamera(),O.noPan||O.panCamera(),O.object.position.addVectors(O.target,C),O.object.isPerspectiveCamera?(O.checkDistances(),O.object.lookAt(O.target),H.distanceToSquared(O.object.position)>v&&(O.dispatchEvent(e),H.copy(O.object.position))):O.object.isOrthographicCamera?(O.object.lookAt(O.target),(H.distanceToSquared(O.object.position)>v||N!==O.object.zoom)&&(O.dispatchEvent(e),H.copy(O.object.position),N=O.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){L=R.NONE,V=R.NONE,O.target.copy(O.target0),O.object.position.copy(O.position0),O.object.up.copy(O.up0),O.object.zoom=O.zoom0,O.object.updateProjectionMatrix(),C.subVectors(O.object.position,O.target),O.object.lookAt(O.target),O.dispatchEvent(e),H.copy(O.object.position),N=O.object.zoom},this.dispose=function(){O.domElement.removeEventListener("contextmenu",b),O.domElement.removeEventListener("pointerdown",i),O.domElement.removeEventListener("pointercancel",r),O.domElement.removeEventListener("wheel",u),O.domElement.removeEventListener("pointermove",a),O.domElement.removeEventListener("pointerup",s),window.removeEventListener("keydown",p),window.removeEventListener("keyup",d)},this.domElement.addEventListener("pointermove",a),this.domElement.addEventListener("contextmenu",b),this.domElement.addEventListener("pointerdown",i),this.domElement.addEventListener("pointercancel",r),this.domElement.addEventListener("wheel",u,{passive:!1}),window.addEventListener("keydown",p),window.addEventListener("keyup",d),this.handleResize(),this.update()}}THREE.TrackballControls=n}();